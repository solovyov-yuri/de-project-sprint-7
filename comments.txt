Привет!

1. Столкнулся с проблемой: No module named 'timezonefinder', если запускать через spark-submit.
Раньше работало, потом перестало. "pip install timezonefinder" не помогает.

Тестировал в юпитере, поэтому не уверен, что все правильно работает.

2. Не понял, как определять расстояние между пользователями.. Координат получателя нет.
Определял координаты на конец дня и по ним считал расстояние.

3. Вынес часть функций в модуль utils. Так вообще принято для потоков? Все, что раньше видел - все в одном файле.

4. Тесты не стал писать - уже очень трудоемко получилось.